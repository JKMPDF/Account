import{r as p,C as N,d as D,j as e,B as R,t as v,H as y}from"./index-D93vVwhB.js";import{c as P,d as L,b as S}from"./accounting-tZ5hxOR_.js";import{c as C}from"./pdfGenerator-BheaZc2-.js";import{f as j}from"./exportUtils-JZTId_Jh.js";const u=({item:a,level:l,isExpanded:d,onToggle:f,currencySymbol:x})=>{var i,m;const o=a.children&&a.children.length>0||a.ledgers&&a.ledgers.length>0,s=l===0,h=l===1,b={paddingLeft:`${l*1.5}rem`};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:`border-b border-slate-200 dark:border-slate-700/50 ${s?"bg-slate-100 dark:bg-slate-900/50":"hover:bg-slate-50 dark:hover:bg-slate-700/30"}`,children:[e.jsx("td",{className:`p-3 ${s?"font-extrabold text-slate-800 dark:text-slate-100":"text-slate-700 dark:text-slate-300"} ${h?"font-bold":""}`,style:b,children:e.jsxs("button",{onClick:()=>o&&f(a.id),className:"flex items-center gap-2 text-left",disabled:!o,children:[o&&e.jsx(y,{className:`w-4 h-4 transition-transform ${d?"rotate-90":""}`}),!o&&e.jsx("div",{className:"w-4 h-4"}),a.title]})}),e.jsxs("td",{className:`p-3 text-right font-mono ${s?"font-extrabold text-slate-800 dark:text-slate-100":"text-slate-700 dark:text-slate-300"} ${h?"font-bold":""}`,children:[x," ",Math.abs(a.total).toFixed(2)]})]}),d&&o&&e.jsxs(e.Fragment,{children:[(i=a.children)==null?void 0:i.map(n=>e.jsx(u,{item:n,level:l+1,isExpanded:d,onToggle:f,currencySymbol:x},n.id)),(m=a.ledgers)==null?void 0:m.map(n=>e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700/50 hover:bg-slate-50 dark:hover:bg-slate-700/30",children:[e.jsx("td",{className:"p-3 text-slate-600 dark:text-slate-400",style:{paddingLeft:`${(l+2)*1.5}rem`},children:n.name}),e.jsxs("td",{className:"p-3 text-right font-mono text-slate-600 dark:text-slate-400",children:[x," ",Math.abs(n.balance).toFixed(2)]})]},n.id))]})]})},A=()=>{const a=p.useContext(N),{startDate:l,endDate:d}=D(),[f,x]=p.useState(new Set),{companyData:o}=a,{ledgers:s=[],vouchers:h=[],details:b}=o,{reportData:i,plRawData:m}=p.useMemo(()=>{if(!(s!=null&&s.length))return{reportData:[],plRawData:null};const{transactions:t}=P(s,h,l,d),c=L(s,t),r=S(s,t);return{reportData:c,plRawData:r}},[s,h,l,d]);p.useEffect(()=>{const t=new Set;i.forEach(c=>{var r;t.add(c.id),(r=c.children)==null||r.forEach(g=>{t.add(g.id)})}),x(t)},[i]);const n=t=>{x(c=>{const r=new Set(c);return r.has(t)?r.delete(t):r.add(t),r})},k=()=>{if(o&&m){const{incomeLedgers:t,expenseLedgers:c,totalIncome:r,totalExpense:g,netProfit:w}=m;C(t,c,r,g,w,l,d,o)}};return e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100",children:"Profit & Loss Statement (Schedule III)"}),e.jsxs("p",{className:"text-lg text-slate-500 dark:text-slate-400",children:["For the period from ",e.jsx("span",{className:"font-semibold text-sky-500 dark:text-sky-400",children:j(l)})," to ",e.jsx("span",{className:"font-semibold text-sky-500 dark:text-sky-400",children:j(d)})]})]}),e.jsxs(R,{onClick:k,variant:"secondary",children:[e.jsx(v,{className:"w-5 h-5 mr-2"}),"Download PDF"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg overflow-hidden border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-medium",children:"PARTICULARS"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"AMOUNT"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsx(u,{item:t,level:0,isExpanded:f.has(t.id),onToggle:n,currencySymbol:b.currencySymbol},t.id))})]})})})]})};export{A as default};
