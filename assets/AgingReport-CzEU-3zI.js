import{r as i,C as M,j as e,B as N}from"./index-D93vVwhB.js";const B=()=>{const{companyData:v}=i.useContext(M),{ledgers:u,vouchers:g}=v,[c,f]=i.useState("Receivables"),[m,D]=i.useState(new Date().toISOString().split("T")[0]),[d,R]=i.useState([0,30,60,90]),x=i.useMemo(()=>{const t=c==="Receivables"?"Sundry Debtors":"Sundry Creditors",s=u.filter(a=>a.group===t),r=new Date(m);return s.map(a=>{let b=(a.openingBalanceType==="Dr"?1:-1)*(a.openingBalance||0);const j=[];g.forEach(o=>{const l=o.entries.find(n=>n.ledgerId===a.id);if(l){const n=(l.type==="Dr"?1:-1)*l.amount;b+=n,j.push({date:new Date(o.date),amount:n})}});const k=Array(d.length+1).fill(0);let p=b;return j.sort((o,l)=>l.date.getTime()-o.date.getTime()).forEach(o=>{if(p===0)return;const l=Math.floor((r.getTime()-o.date.getTime())/(1e3*3600*24));if(l<0)return;let n=d.findIndex(w=>l<=w);n===-1&&(n=d.length);const y=Math.min(Math.abs(p),Math.abs(o.amount));k[n]+=(c==="Receivables"?1:-1)*y,p-=y}),{ledgerName:a.name,totalBalance:b,buckets:k}}).filter(a=>Math.abs(a.totalBalance)>.01)},[c,m,d,u,g]),h=d.map((t,s)=>{const r=d[s+1];return r?`${t+1}-${r} Days`:`> ${t} Days`});return h.unshift(`0-${d[0]} Days`),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 mb-6",children:"Aging Report"}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow-md border border-slate-200 dark:border-slate-700 mb-6 flex flex-wrap items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Report For"}),e.jsxs("div",{className:"flex gap-1 bg-slate-200 dark:bg-slate-700 p-1 rounded-md",children:[e.jsx(N,{variant:c==="Receivables"?"primary":"secondary",onClick:()=>f("Receivables"),className:"!px-3 !py-1 text-sm",children:"Receivables"}),e.jsx(N,{variant:c==="Payables"?"primary":"secondary",onClick:()=>f("Payables"),className:"!px-3 !py-1 text-sm",children:"Payables"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"asOnDate",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"As on Date"}),e.jsx("input",{type:"date",id:"asOnDate",value:m,onChange:t=>D(t.target.value),className:"block w-full px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm"})]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg overflow-hidden border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-medium",children:"Particulars"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Total Outstanding"}),h.map(t=>e.jsx("th",{className:"p-3 font-medium text-right",children:t},t))]})}),e.jsx("tbody",{children:x.map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700/50 hover:bg-slate-50 dark:hover:bg-slate-700/30",children:[e.jsx("td",{className:"p-3 text-slate-800 dark:text-slate-200",children:t.ledgerName}),e.jsx("td",{className:"p-3 text-right font-mono font-bold",children:Math.abs(t.totalBalance).toFixed(2)}),t.buckets.map((r,a)=>e.jsx("td",{className:"p-3 text-right font-mono",children:Math.abs(r)>.01?Math.abs(r).toFixed(2):"-"},a))]},s))}),e.jsx("tfoot",{className:"bg-slate-100 dark:bg-slate-900/50 font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-3 text-slate-800 dark:text-slate-200",children:"Grand Total"}),e.jsx("td",{className:"p-3 text-right font-mono",children:Math.abs(x.reduce((t,s)=>t+s.totalBalance,0)).toFixed(2)}),h.map((t,s)=>e.jsx("td",{className:"p-3 text-right font-mono",children:Math.abs(x.reduce((r,a)=>r+a.buckets[s],0)).toFixed(2)},s))]})})]})})})]})};export{B as default};
